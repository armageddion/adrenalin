  <UserControl xmlns="https://github.com/avaloniaui"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:local="using:Adrenalin.Converters"
              xmlns:views="using:Adrenalin.Views"
              xmlns:vm="using:Adrenalin.ViewModels"
               x:Class="Adrenalin.Views.MembersView" x:DataType="vm:MembersViewModel">
    <UserControl.Resources>
        <local:StringEqualsConverter x:Key="StringEqualsConverter" />
        <local:Int32GreaterThanConverter x:Key="Int32GreaterThanConverter" />
        <local:Int32LessThanConverter x:Key="Int32LessThanConverter" />
    </UserControl.Resources>
   <Grid>
     <Grid.RowDefinitions>
       <RowDefinition Height="Auto"/>
       <RowDefinition Height="*"/>
       <RowDefinition Height="Auto"/>
     </Grid.RowDefinitions>

       <!-- Search and Actions -->
       <StackPanel Grid.Row="0" Margin="20,20,20,10" Spacing="10" IsVisible="{Binding CurrentView, Converter={StaticResource StringEqualsConverter}, ConverterParameter=list}">
         <TextBox Text="{Binding SearchQuery}" Watermark="{Binding SearchPlaceholder}" />
         <StackPanel Orientation="Horizontal" Spacing="10">
           <Button Content="{Binding AddMemberLabel}" Command="{Binding AddMember}" />
           <Button Content="Refresh" Command="{Binding LoadMembers}" />
         </StackPanel>
       </StackPanel>

      <!-- Back Button for Detail -->
      <Button Grid.Row="0" Content="{Binding BackToMembersLabel}" Command="{Binding BackToList}" Margin="20" IsVisible="{Binding CurrentView, Converter={StaticResource StringEqualsConverter}, ConverterParameter=detail}" />

     <!-- Members List -->
     <ScrollViewer x:Name="MembersList" Grid.Row="1" Margin="20,0,20,20" IsVisible="{Binding CurrentView, Converter={StaticResource StringEqualsConverter}, ConverterParameter=list}">
       <ItemsControl ItemsSource="{Binding Members}">
         <ItemsControl.ItemsPanel>
           <ItemsPanelTemplate>
             <WrapPanel Orientation="Horizontal" />
           </ItemsPanelTemplate>
         </ItemsControl.ItemsPanel>
         <ItemsControl.ItemTemplate>
           <DataTemplate>
              <Button Margin="5" Padding="10" Background="{DynamicResource SystemControlBackgroundAltHighBrush}" BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}" BorderThickness="1" CornerRadius="5" Command="{Binding $parent[ItemsControl].DataContext.SelectMember}" CommandParameter="{Binding}">
               <Grid Width="200" Height="150">
                 <Grid.RowDefinitions>
                   <RowDefinition Height="Auto"/>
                   <RowDefinition Height="*"/>
                 </Grid.RowDefinitions>
                 <Image Grid.Row="0" Source="{Binding Image}" Width="50" Height="50" HorizontalAlignment="Center" Margin="0,0,0,10" />
                 <StackPanel Grid.Row="1" Spacing="5">
                   <TextBlock Text="{Binding FirstName}" FontWeight="Bold" HorizontalAlignment="Center" />
                   <TextBlock Text="{Binding LastName}" FontWeight="Bold" HorizontalAlignment="Center" />
                    <TextBlock Text="{Binding CardId}" FontSize="12" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" HorizontalAlignment="Center" />
                   <TextBlock Text="{Binding PackageId, StringFormat='Package: {0}'}" FontSize="12" HorizontalAlignment="Center" />
                   <TextBlock Text="{Binding ExpiresAt, StringFormat='Expires: {0:d}'}" FontSize="12" HorizontalAlignment="Center" />
                 </StackPanel>
               </Grid>
             </Button>
           </DataTemplate>
         </ItemsControl.ItemTemplate>
       </ItemsControl>
     </ScrollViewer>

     <!-- Member Detail -->
      <views:MemberDetailView x:Name="MemberDetail" Grid.Row="1" IsVisible="{Binding IsDetailVisible}" />

      <!-- Loading Indicator -->
      <TextBlock Grid.Row="1" Text="{Binding $parent[UserControl].DataContext.LoadingLabel}" IsVisible="{Binding IsLoading}" HorizontalAlignment="Center" VerticalAlignment="Center" />

      <!-- Pagination -->
      <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="20" Spacing="10" IsVisible="{Binding CurrentView, Converter={StaticResource StringEqualsConverter}, ConverterParameter=list}">
        <Button Content="Previous" Command="{Binding PreviousPage}" IsEnabled="{Binding CurrentPage, Converter={StaticResource Int32GreaterThanConverter}, ConverterParameter=1}" />
        <TextBlock Text="{Binding CurrentPage, StringFormat='Page {0} of {1}'}" VerticalAlignment="Center" />
        <Button Content="Next" Command="{Binding NextPage}" IsEnabled="{Binding CurrentPage, Converter={StaticResource Int32LessThanConverter}, ConverterParameter={Binding TotalPages}}" />
      </StackPanel>
   </Grid>
 </UserControl>
